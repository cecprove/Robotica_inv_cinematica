% function per definire il funzionale di costo: "funzione di manipolabilità" 
function dw = funzionale_costo() 
 syms q1 q2 q3 q4 'real'
 syms a1 a2 a3 a4 'real'
 
 w=sqrt(2*a1^2*a2^2*cos(q1 + q2)^2*sin(q1)^2 + 2*a1^2*a2^2*sin(q1 + q2)^2*cos(q1)^2 ...
            + 2*a2^2*a3^2*cos(q1 + q2 + q3)^2*sin(q1 + q2)^2 + 2*a2^2*a3^2*sin(q1 + q2 + q3)^2*cos(q1 + q2)^2 +...
            2*a1^2*a3^2*cos(q1 + q2 + q3)^2*sin(q1)^2 + 2*a1^2*a3^2*sin(q1 + q2 + q3)^2*cos(q1)^2 - 4*a2^2*a3^2*cos(q1 + q2 + q3)*sin(q1 + q2 + q3)*cos(q1 + q2)*sin(q1 + q2) ...
            - 4*a1^2*a3^2*cos(q1 + q2 + q3)*sin(q1 + q2 + q3)*cos(q1)*sin(q1) + 2*a1*a2*a3^2*sin(q1 + q2 + q3)^2*cos(q1 + q2)*cos(q1) +...
            2*a1^2*a2*a3*cos(q1 + q2 + q3)*cos(q1 + q2)*sin(q1)^2 + 2*a1*a2*a3^2*cos(q1 + q2 + q3)^2*sin(q1 + q2)*sin(q1)...
            + 2*a1^2*a2*a3*sin(q1 + q2 + q3)*sin(q1 + q2)*cos(q1)^2 - 4*a1^2*a2^2*cos(q1 + q2)*sin(q1 + q2)*cos(q1)*sin(q1) - 2*a1^2*a2*a3*cos(q1 + q2 + q3)*sin(q1 + q2)*cos(q1)*sin(q1) ...
            - 2*a1^2*a2*a3*sin(q1 + q2 + q3)*cos(q1 + q2)*cos(q1)*sin(q1) - 2*a1*a2*a3^2*cos(q1 + q2 + q3)*sin(q1 + q2 + q3)*cos(q1 + q2)*sin(q1) -...
            2*a1*a2*a3^2*cos(q1 + q2 + q3)*sin(q1 + q2 + q3)*sin(q1 + q2)*cos(q1));
        
        dw = simplify(diff(w, 'q1')) + simplify(diff(w, 'q2')) +simplify(diff(w, 'q3')) + simplify(diff(w, 'q4'));
 
end
